USE RedBook
GO

--
--insert IM_Animals
--
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Amur_tiger', 'Амурский тигр', 'Хищные', 'Хордовые', 200);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Muskrat', 'Выхухоль', 'Насекомоядные', 'Хордовые', 0.45);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Comb_Newt', 'Гребенчатый тритон', 'Хвостатые земноводные', 'Хордовые', 0.013);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Steppe_eagle', 'Степной орел', 'Соколообразные', 'Хордовые', 3.5);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Japanese_crab', 'Японский краб', 'Десятиногие', 'Членистоногие', 15);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Azov_Beluga', 'Азовская белуга', 'Осетрообразные', 'Хордовые', 500);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Stag_beetle', 'Жук-олень', 'Жесткокрылые', 'Членистоногие', 0.08);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Bison', 'Зубр', 'Парнокопытные', 'Хордовые', 900);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Snow_Leopard', 'Снежный барс', 'Хищные', 'Хордовые', 55);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Legged_hatopterus', 'Разноногий хетоптерус', 'Щетинко-крылообразные', 'Кольчатые черви', 0.012);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Cat_snake', 'Кошачья змея', 'Чешуйчатые', 'NULL', 0.3);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Sharp-eyed_night', 'Остроухая ночница', 'Рукокрылые', 'Хордовые', 0.03);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Monk_seal', 'Тюлень-монах', 'Хищные', 'Хордовые', 300);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Passageway', 'Проехидна', 'Клоачные', 'Хордовые', 10);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Sumatran_Rhino', 'Носорог  суматранский', 'Непарнокопытные', 'Хордовые', 800);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Forest_giraffe', 'Лесной жираф', 'Парнокопытные', 'Хордовые', 230);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Marsupial_devil', 'Сумчатый дьявол', 'Хищные', 'Хордовые', 12);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Manul', 'Манул', 'Хищные', 'Хордовые', 4);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Stargazer', 'Звездонос', 'Насекомоядные', 'NULL', 0.085);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Grizzly_bear', 'Гризли медведь', 'Всеядные', 'Хордовые', 450);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Mountain_gorilla', 'Горная горилла', 'Приматы', 'Хордовые', 160);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Rhinoceros_Javanese', 'Носорог яванский', 'Непарнокопытные', 'Хордовые', 2100);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Big_panda', 'Большая панда', 'Хищные', 'Хордовые', 160);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Magellanic_Penguin', 'Магелланов пингвин', 'Пингвинообразные', 'Хордовые', 5);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Polar_bear', 'Белый медведь', 'Хищные', 'Хордовые', 350);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Pacific_walruses', 'Тихоокенские моржи', 'Хищные', 'Хордовые', 1000);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('California_condor', 'Калифорнийский кондор', 'Соколообразные', 'Хордовые', 14);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Pre-Wwalski_Horse', 'Лошадь Прежвальского', 'Непарнокопытные', 'Хордовые', 325);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Red-crowned_crane', 'Японский журавль', 'Журавлеобразные', 'NULL', 7.05);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Manatee', 'Ламантин', 'Сирены', 'Хордовые', 830);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Bactrian', 'Бактриан', 'Парнокопытные', 'Хордовые', 570);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Madagascar_shepherds', 'Мадагаскарские пастушки', 'Журавлеобразные', 'Хордовые', 2);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Grevys_Zebra', 'Зебра Греви', 'Непарнокопытные', 'Хордовые', 400);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Lemur', 'Лемур', 'Приматы', 'Хордовые', 3.05);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Lion', 'Лев', 'Хищные', 'Хордовые', 180);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Smoky_leopard', 'Дымчатый леопард', 'Хищные', 'Хордовые', 20);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Mouse', 'Мышь', 'Грызуны', 'Хордовые', 0.01);
INSERT INTO dbo.IM_Animals (AnimalCode, AnimalName, SquadName, TypeName, TypicalWeight) VALUES ('Elephant_indian', 'Слон индийский', 'Хоботные', 'Хордовые', 3800);


--
--insert IM_Squads
--
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Omnivores', 'Всеядные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Rodents', 'Грызуны');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Decapods', 'Десятиногие');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Winged', 'Жесткокрылые');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Crane-like', 'Журавлеобразные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Foul', 'Клоачные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Insectivores', 'Насекомоядные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Ungulate', 'Непарнокопытные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Sturgeon-like', 'Осетрообразные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Artiodactyls', 'Парнокопытные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Penguin-like', 'Пингвинообразные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Primates', 'Приматы');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Bats', 'Рукокрылые');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Sirens', 'Сирены');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Falconiformes', 'Соколообразные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Tailed amphibians', 'Хвостатые земноводные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Predatory', 'Хищные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Proboscis', 'Хоботные');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Scaly', 'Чешуйчатые');
INSERT INTO dbo.IM_Squads (SquadCode, SquadName) VALUES ('Bristle-winged', 'Щетинко-крылообразные');


--
--insert IM_Types
--
INSERT INTO dbo.IM_Types (TypeCode, TypeName) VALUES ('Annelids', 'Кольчатые черви');
INSERT INTO dbo.IM_Types (TypeCode, TypeName) VALUES ('Chordate', 'Хордовые');
INSERT INTO dbo.IM_Types (TypeCode, TypeName) VALUES ('Arthropods', 'Членистоногие');


--
--IM_Animals
--update
UPDATE a
SET a.SquadCode = s.SquadCode,  
    a.TypeCode = t.TypeCode
FROM dbo.IM_Animals a
     LEFT JOIN dbo.IM_Squads s
	   ON a.SquadName = s.SquadName
	 LEFT JOIN dbo.IM_Types t
	   ON a.TypeName = t.TypeName;
--drop columns
ALTER TABLE IM_Animals DROP COLUMN SquadName;
ALTER TABLE IM_Animals DROP COLUMN TypeName;
--alter columns
ALTER TABLE IM_Animals ALTER COLUMN SquadCode NVARCHAR(100) NOT NULL;


--
--insert IM_Countries
--
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('RUS', 'Россия                   ', 'Евразия                  ', 'Москва                   ', 93);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('LVA', 'Латвия                   ', 'Евразия                  ', 'Рига', 4);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('CHN', 'Китай                    ', 'Евразия                  ', 'Пекин', 319);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('BLR', 'Белорусь                 ', 'Евразия                  ', 'Минск', 6);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('KAZ', 'Казахстан                ', 'Евразия                  ', 'Астана                   ', 10);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('JPN', 'Япония                   ', 'Евразия                  ', 'Токио                    ', 7);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('UKR', 'Украина                  ', 'Евразия                  ', 'Киев                     ', 19);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('IND', 'Индия                    ', 'Евразия                  ', 'Нью-Дели                 ', 34);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('MNG', 'Монголия                 ', 'Евразия                  ', 'Улан-Батор               ', 11);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('TJK', 'Таджикистан              ', 'Евразия                  ', 'Душанбе                  ', 5);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('ARM', 'Армения                  ', 'Евразия                  ', 'Ереван                   ', 5);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('GRC', 'Греция                   ', 'Евразия                  ', 'Афины                    ', NULL);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('IDN', 'Индонезия                ', 'Евразия                  ', 'Джакарта                 ', 6);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('MMR', 'Мьянма                   ', 'Евразия                  ', 'Нейпьидо                 ', 2);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('BGD', 'Бангладеш                ', 'Евразия                  ', 'Дакка                    ', 3);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('COG', 'Республика Конго                    ', 'Африка                   ', 'Киншаса                  ', 5);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('AUS', 'Австралия                ', 'Австралия                ', 'Канберра                 ', 4);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('CAN', 'Канада                   ', 'Северная Америка         ', 'Оттава                   ', 15);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('USA', 'США                      ', 'Северная Америка         ', 'Вашингтон                ', 50);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('VNM', 'Вьетнам                  ', 'Евразия                  ', 'Ханой                    ', 34);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('CHL', 'Чили                     ', 'Южная Америка            ', 'Саньтьяго                ', NULL);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('ARG', 'Аргентина                ', 'Южная Америка   ', 'Буенос-Айрес             ', 23);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('GAB', 'Габон                    ', 'Африка                   ', 'Либревиль                ', 3);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('NGA', 'Нигерия                  ', 'Африка                   ', 'Абудже                   ', NULL);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('MDG', 'Мадагаскар               ', 'Африка                   ', 'Антананариву             ', 2);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('KEN', 'Кения                    ', 'Африка                   ', 'Найроби                  ', 3);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('LUX', 'Люксенбург               ', 'Евразия                  ', 'Люксенбург               ', NULL);
INSERT INTO dbo.IM_Countries (CountryCode, CountryName, ContinentName, Capital, AmountNationalReserves) VALUES ('DNK', 'Дания                    ', 'Евразия                  ', 'Копенгаген               ', NULL);

UPDATE IM_Countries
SET CountryName = LTRIM(RTRIM(CountryName)),
    ContinentName = LTRIM(RTRIM(ContinentName)),
	Capital = LTRIM(RTRIM(Capital))


--
--insert IM_Continents
--
INSERT INTO dbo.IM_Continents (ContinentCode, ContinentName) VALUES ('Africa', 'Африка');
INSERT INTO dbo.IM_Continents (ContinentCode, ContinentName) VALUES ('Antarctica', 'Антарктида');
INSERT INTO dbo.IM_Continents (ContinentCode, ContinentName) VALUES ('Australia', 'Австралия');
INSERT INTO dbo.IM_Continents (ContinentCode, ContinentName) VALUES ('Eurasia', 'Евразия');
INSERT INTO dbo.IM_Continents (ContinentCode, ContinentName) VALUES ('North America', 'Северная Америка');
INSERT INTO dbo.IM_Continents (ContinentCode, ContinentName) VALUES ('South America', 'Южная Америка');

--
--IM_Countries
--update
UPDATE c
SET c.ContinentCode = cc.ContinentCode
FROM dbo.IM_Countries c
     LEFT JOIN dbo.IM_Continents cc
	   ON c.ContinentName = cc.ContinentName;
--drop column
ALTER TABLE IM_Countries DROP COLUMN ContinentName;
--alter column
ALTER TABLE IM_Countries ALTER COLUMN ContinentCode NVARCHAR(100) NOT NULL;

--
--insert IM_Habitat
--
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Amur_tiger', 'RUS', 450);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Amur_tiger', 'CHN', 50);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Muskrat', 'RUS', 35000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Comb_Newt', 'RUS', 250);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Comb_Newt', 'LVA', 50);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Comb_Newt', 'BLR', 30);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Steppe_eagle', 'RUS', 20000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Steppe_eagle', 'KAZ', 10000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Japanese_crab', 'RUS', 100);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Japanese_crab', 'JPN', 500);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Azov_Beluga', 'RUS', 24000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Stag_beetle', 'RUS', 20000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Bison', 'RUS', 500);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Bison', 'UKR', 150);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Snow_Leopard', 'RUS', 200);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Snow_Leopard', 'CHN', 3500);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Snow_Leopard', 'IND', 600);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Snow_Leopard', 'MNG', 1000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Snow_Leopard', 'TJK', 220);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Legged_hatopterus', 'RUS', 80);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Legged_hatopterus', 'CHN', 500);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Cat_snake', 'RUS', 100);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Cat_snake', 'ARM', 600);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Sharp-eyed_night', 'RUS', 500000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Monk_seal', 'GRC', 1000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Passageway', 'IDN', 300000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Sumatran_Rhino', 'IDN', 30);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Sumatran_Rhino', 'MMR', 80);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Sumatran_Rhino', 'BGD', 120);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Forest_giraffe', 'COG', 10000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Marsupial_devil', 'AUS', 100000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Manul', 'RUS', 2300);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Manul', 'CHN', 1000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Stargazer', 'CAN', 40000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Grizzly_bear', 'USA', 600);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Mountain_gorilla', 'COG', 720);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Rhinoceros_Javanese', 'VNM', 60);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Big_panda', 'CHN', 1600);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Magellanic_Penguin', 'CHL', 800000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Magellanic_Penguin', 'ARG', 900000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Polar_bear', 'RUS', 18000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Polar_bear', 'CAN', 4000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Pacific_walruses', 'RUS', 200000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('California_condor', 'USA', 120);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Pre-Wwalski_Horse', 'CHN', 500);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Pre-Wwalski_Horse', 'MNG', 400);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Red-crowned_crane', 'RUS', 500);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Red-crowned_crane', 'JPN', 1500);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Manatee', 'GAB', 1500);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Manatee', 'NGA', 1700);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Bactrian', 'KAZ', 200);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Bactrian', 'MNG', 700);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Madagascar_shepherds', 'MDG', 12000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Grevys_Zebra', 'KEN', 5000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Lemur', 'MDG', 1000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('a_lion', 'IND', 200);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('a_lion', 'BGD', 100);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('a_lion', 'KEN', 180);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Smoky_leopard', 'IDN', 570);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Smoky_leopard', 'VNM', 600);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Mouse', 'RUS', 40000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Mouse', 'CHN', 30000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Mouse', 'BLR', 42000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Mouse', 'UKR', 50000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Elephant_indian', 'IND', 10000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Elephant_indian', 'IDN', 9000);
INSERT INTO dbo.IM_Habitat (AnimalCode, CountryCode, Population) VALUES ('Elephant_indian', 'VNM', 8000);


--
--CT_Squads
--
UPDATE CT_Squads
SET SquadName = IM_Squads.SquadName
FROM IM_Squads
WHERE CT_Squads.SquadCode = IM_Squads.SquadCode;

INSERT INTO CT_Squads (SquadCode, SquadName)
SELECT im.SquadCode, im.SquadName
FROM IM_Squads im
     LEFT JOIN CT_Squads ct
	   ON im.SquadCode = ct.SquadCode
WHERE ct.SquadId IS NULL;


--
--CT_Types
--
UPDATE CT_Types
SET TypeName = (SELECT TypeName 
                FROM IM_Types 
				WHERE CT_Types.TypeCode = IM_Types.TypeCode);

INSERT INTO CT_Types (TypeCode, TypeName)
SELECT im.TypeCode, im.TypeName
FROM IM_Types im
     LEFT JOIN CT_Types ct
	   ON im.TypeCode = ct.TypeCode
WHERE ct.TypeId IS NULL;


--
--SK_Animals
--
UPDATE SK_Animals
SET AnimalName = IM_Animals.AnimalName,
    SquadId = CT_Squads.SquadId,
	TypeId = CT_Types.TypeId,
	TypicalWeight = IM_Animals.TypicalWeight
FROM IM_Animals 
     JOIN CT_Squads
	   ON IM_Animals.SquadCode = CT_Squads.SquadCode
	 LEFT JOIN CT_Types
	   ON IM_Animals.TypeCode = CT_Types.TypeCode
     JOIN SK_Animals
	   ON IM_Animals.AnimalCode = SK_Animals.AnimalCode;

INSERT INTO SK_Animals (AnimalCode, AnimalName, SquadId, TypeId, TypicalWeight)
SELECT IM_Animals.AnimalCode, IM_Animals.AnimalName, CT_Squads.SquadId, CT_Types.TypeId, IM_Animals.TypicalWeight
FROM IM_Animals 
     JOIN CT_Squads
	   ON IM_Animals.SquadCode = CT_Squads.SquadCode
	 LEFT JOIN CT_Types
	   ON IM_Animals.TypeCode = CT_Types.TypeCode
     LEFT JOIN SK_Animals
	   ON IM_Animals.AnimalCode = SK_Animals.AnimalCode
WHERE SK_Animals.AnimalId IS NULL;


--
--CT_Continents
--
UPDATE CT_Continents
SET ContinentName = IM_Continents.ContinentName
FROM IM_Continents
WHERE CT_Continents.ContinentCode = IM_Continents.ContinentCode;

INSERT INTO CT_Continents (ContinentCode, ContinentName)
SELECT im.ContinentCode, im.ContinentName
FROM IM_Continents im
     LEFT JOIN CT_Continents ct
	   ON im.ContinentCode = ct.ContinentCode
WHERE ct.ContinentId IS NULL;


--
--SK_Countries
--
UPDATE SK_Countries
SET CountryName = IM_Countries.CountryName,
	ContinentId = CT_Continents.ContinentId,
	Capital = IM_Countries.Capital, 
	AmountNationalReserves = IM_Countries.AmountNationalReserves
FROM IM_Countries 
     JOIN CT_Continents
	   ON IM_Countries.ContinentCode = CT_Continents.ContinentCode
     JOIN SK_Countries
	   ON IM_Countries.CountryCode = SK_Countries.CountryCode;

INSERT INTO SK_Countries (CountryCode, CountryName, ContinentId, Capital, AmountNationalReserves)
SELECT IM_Countries.CountryCode, IM_Countries.CountryName, CT_Continents.ContinentId, IM_Countries.Capital, IM_Countries.AmountNationalReserves
FROM IM_Countries 
     JOIN CT_Continents
	   ON IM_Countries.ContinentCode = CT_Continents.ContinentCode
     LEFT JOIN SK_Countries
	   ON IM_Countries.CountryCode = SK_Countries.CountryCode
WHERE SK_Countries.CountryId IS NULL;


--
--RS_Habitat
--
UPDATE RS_Habitat
SET RS_Habitat.Population = IM_Habitat.Population
FROM IM_Habitat
     JOIN SK_Animals
	   ON IM_Habitat.AnimalCode = SK_Animals.AnimalCode
	 JOIN SK_Countries
	   ON IM_Habitat.CountryCode = SK_Countries.CountryCode
     JOIN RS_Habitat
	   ON SK_Animals.AnimalId = RS_Habitat.AnimalId
	      AND SK_Countries.CountryId = RS_Habitat.CountryId;

INSERT INTO RS_Habitat (AnimalId, CountryId, Population)
SELECT SK_Animals.AnimalId, SK_Countries.CountryId, IM_Habitat.Population
FROM IM_Habitat
     JOIN SK_Animals
	   ON IM_Habitat.AnimalCode = SK_Animals.AnimalCode
	 JOIN SK_Countries
	   ON IM_Habitat.CountryCode = SK_Countries.CountryCode
     LEFT JOIN RS_Habitat
	   ON SK_Animals.AnimalId = RS_Habitat.AnimalId
	      AND SK_Countries.CountryId = RS_Habitat.CountryId
WHERE RS_Habitat.HabitatId IS NULL;